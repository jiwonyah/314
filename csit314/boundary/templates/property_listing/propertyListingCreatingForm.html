{% extends 'base.html' %}
{% block content %}
<style>
  textarea {
    width: 100%;
    height: 6.25em;
    resize: none;
  }
      /* 전체 폼 스타일 */
  form {
    max-width: 600px;
    margin: 0 auto;
    padding: 30px;
    background-color: #f5f5f5;
    border-radius: 10px;
    box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
  }

  /* 입력 필드 스타일 */
  input[type="text"], input[type="number"], textarea, select {
    width: 100%;
    padding: 12px 20px;
    margin: 8px 0;
    display: inline-block;
    border: 1px solid #ccc;
    border-radius: 4px;
    box-sizing: border-box;
  }

  /* 버튼 스타일 */
  button[type="submit"] {
    background-color: #4CAF50;
    color: white;
    padding: 14px 20px;
    margin: 8px 0;
    border: none;
    border-radius: 4px;
    cursor: pointer;
  }

  button[type="submit"]:hover {
    background-color: #45a049;
  }

  /* 에러 메시지 스타일 */
  #formError {
    color: red;
    font-weight: bold;
    margin-bottom: 10px;
  }
</style>
<div>
    <h1>Register Property Listing</h1>
    <form id="createPropertyForm" method="POST" action="/propertyListing/create/"
    enctype="multipart/form-data">
        {{ form.csrf_token }}

        <div>
            <label for="subject">Subject*</label>
            <input type="text" id="subject" name="subject" required>
        </div>
        <br><br>
        <div>
             <label for="images">Upload Images</label>
            <input type="file" name="images" id="images" multiple>
        </div>
        <br><br>
        <div>
            <label for="content">Property Listing Description</label>
            <textarea name="content" id="content" rows="10"></textarea>
        </div>
        <br><br>
		<div>
            <label for="price">Price*</label>
            <input type="number" name="price" id="price">
        </div>
        <br><br>
		<div>
            <label for="address">Address*</label>
            <input type="text" name="address" id="address">
        </div>
        <br><br>
		<div>
            <label for="floorSize">Floor Size*</label>
            <input type="number" name="floorSize" id="floorSize">
        </div>
        <br><br>
		<div>
            <label for="floorLevel">Floor Level*</label>
                <select name="floorLevel" id="floorLevel">
                    {% for value, label in form.floorLevel.choices %}
                        <option value="{{ value }}" {% if form.floorLevel.data == value %}selected{% endif %}>{{ label }}</option>
                    {% endfor %}
                </select>
        </div>
        <br><br>
		<div>
            <label for="propertyType">Property type*</label>
                <select name="propertyType" id="propertyType" required>
                    {% for value, label in form.propertyType.choices %}
                        <option value="{{ value }}" {% if form.propertyType.data == value %}selected{% endif %}>{{ label }}</option>
                    {% endfor %}
                </select>
        </div>
        <br><br>
        <div class="mb-3">
            <label for="furnishing">Furnishing*</label>
                <select name="furnishing" id="furnishing">
                    {% for value, label in form.furnishing.choices %}
                        <option value="{{ value }}" {% if form.furnishing.data == value %}selected{% endif %}>{{ label }}</option>
                    {% endfor %}
                </select>
        </div>
        <br><br>
        <div>
            <label for="builtYear">Built year*</label>
            <input type="number" name="builtYear" id="builtYear">
        </div>
        <br><br>
        <div>
            <label for="client_id">Client*</label>
            <input type="text" name="client_id" id="client_id">
            <div id="formError" style="color: red; display: none;"></div>
        </div>
        <br><br>
        <button type="submit">Submit</button>
    </form>
</div>

<script>
            document.getElementById('createPropertyForm').addEventListener('submit', async (e) => {
            e.preventDefault();

            const formData = new FormData(e.target);
            const response = await fetch('/propertyListing/create/', {
                method: 'POST',
                body: formData
            });

            const data = await response.json();
            if (data.success) {
                alert(data.message);
                window.location.href = '/propertyListing/';
            } else {
                alert(data.error);
                const errorDiv = document.getElementById('formError');
                errorDiv.textContent = data.error;
                errorDiv.style.display = 'block';
            }
        });
</script>
{% endblock %}